<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>LeetCodeæ•°æ®åº“(ç¬¬äºŒå¤©) - P1n93r - åšå­¦è€Œç²¾ä¸€</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="P1n93r"><meta name=description content="[178]åˆ†æ•°æ’å é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š //ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥å®ç°åˆ†æ•°æ’åã€‚ // // å¦‚æœä¸¤ä¸ªåˆ†æ•°ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªåˆ†æ•°æ’åï¼ˆRankï¼‰ç›¸åŒã€‚è¯·æ³¨æ„ï¼Œå¹³åˆ†åçš„ä¸‹ä¸€"><meta name=keywords content="Security,Java,Web,Android"><meta name=generator content="Hugo 0.98.0 with theme even"><link rel=canonical href=https://p1n93r.github.io/post/sql/leetcode%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%BA%8C%E5%A4%A9/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="LeetCodeæ•°æ®åº“(ç¬¬äºŒå¤©)"><meta property="og:description" content="[178]åˆ†æ•°æ’å é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š //ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥å®ç°åˆ†æ•°æ’åã€‚ // // å¦‚æœä¸¤ä¸ªåˆ†æ•°ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªåˆ†æ•°æ’åï¼ˆRankï¼‰ç›¸åŒã€‚è¯·æ³¨æ„ï¼Œå¹³åˆ†åçš„ä¸‹ä¸€"><meta property="og:type" content="article"><meta property="og:url" content="https://p1n93r.github.io/post/sql/leetcode%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%BA%8C%E5%A4%A9/"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-09-16T23:06:36+08:00"><meta property="article:modified_time" content="2020-09-16T23:06:36+08:00"><meta itemprop=name content="LeetCodeæ•°æ®åº“(ç¬¬äºŒå¤©)"><meta itemprop=description content="[178]åˆ†æ•°æ’å é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š //ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥å®ç°åˆ†æ•°æ’åã€‚ // // å¦‚æœä¸¤ä¸ªåˆ†æ•°ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªåˆ†æ•°æ’åï¼ˆRankï¼‰ç›¸åŒã€‚è¯·æ³¨æ„ï¼Œå¹³åˆ†åçš„ä¸‹ä¸€"><meta itemprop=datePublished content="2020-09-16T23:06:36+08:00"><meta itemprop=dateModified content="2020-09-16T23:06:36+08:00"><meta itemprop=wordCount content="2390"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="LeetCodeæ•°æ®åº“(ç¬¬äºŒå¤©)"><meta name=twitter:description content="[178]åˆ†æ•°æ’å é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š //ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥å®ç°åˆ†æ•°æ’åã€‚ // // å¦‚æœä¸¤ä¸ªåˆ†æ•°ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªåˆ†æ•°æ’åï¼ˆRankï¼‰ç›¸åŒã€‚è¯·æ³¨æ„ï¼Œå¹³åˆ†åçš„ä¸‹ä¸€"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>P1n93r</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/about/><li class=mobile-menu-item>About</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>P1n93r</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/about/>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>LeetCodeæ•°æ®åº“(ç¬¬äºŒå¤©)</h1><div class=post-meta><span class=post-time>2020-09-16</span><div class=post-category><a href=/categories/sql/>sql</a></div><span class=more-meta>çº¦ 2390 å­—</span>
<span class=more-meta>é¢„è®¡é˜…è¯» 5 åˆ†é’Ÿ</span>
<span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> æ¬¡é˜…è¯»</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>æ–‡ç« ç›®å½•</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#178åˆ†æ•°æ’å>[178]åˆ†æ•°æ’å</a><ul><li><a href=#è§£æ³•>è§£æ³•</a></li></ul></li><li><a href=#180è¿ç»­å‡ºç°çš„æ•°å­—>[180]è¿ç»­å‡ºç°çš„æ•°å­—</a><ul><li><a href=#è§£æ³•-1>è§£æ³•</a></li></ul></li><li><a href=#181è¶…è¿‡ç»ç†æ”¶å…¥çš„å‘˜å·¥>[181]è¶…è¿‡ç»ç†æ”¶å…¥çš„å‘˜å·¥</a><ul><li><a href=#è§£æ³•-2>è§£æ³•</a></li></ul></li><li><a href=#182æŸ¥æ‰¾é‡å¤çš„ç”µå­é‚®ç®±>[182]æŸ¥æ‰¾é‡å¤çš„ç”µå­é‚®ç®±</a><ul><li><a href=#è§£æ³•-3>è§£æ³•</a></li></ul></li><li><a href=#183ä»ä¸è®¢è´­çš„å®¢æˆ·>[183]ä»ä¸è®¢è´­çš„å®¢æˆ·</a><ul><li><a href=#è§£æ³•-4>è§£æ³•</a></li></ul></li><li><a href=#184éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥>[184]éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥</a><ul><li><a href=#è§£æ³•-5>è§£æ³•</a></li></ul></li><li><a href=#175ç»„åˆä¸¤ä¸ªè¡¨>[175]ç»„åˆä¸¤ä¸ªè¡¨</a><ul><li><a href=#è§£æ³•-6>è§£æ³•</a></li></ul></li><li><a href=#176ç¬¬äºŒé«˜çš„è–ªæ°´>[176]ç¬¬äºŒé«˜çš„è–ªæ°´</a><ul><li><a href=#è§£æ³•-7>è§£æ³•</a></li></ul></li><li><a href=#177ç¬¬né«˜çš„è–ªæ°´>[177]ç¬¬Né«˜çš„è–ªæ°´</a><ul><li><a href=#è§£æ³•å¦‚ä¸‹>è§£æ³•å¦‚ä¸‹ï¼š</a></li></ul></li></ul></li></ul></nav></div></div><div class=post-content><h2 id=178åˆ†æ•°æ’å>[178]åˆ†æ•°æ’å</h2><p>é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>//ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢æ¥å®ç°åˆ†æ•°æ’åã€‚
//
// å¦‚æœä¸¤ä¸ªåˆ†æ•°ç›¸åŒï¼Œåˆ™ä¸¤ä¸ªåˆ†æ•°æ’åï¼ˆRankï¼‰ç›¸åŒã€‚è¯·æ³¨æ„ï¼Œå¹³åˆ†åçš„ä¸‹ä¸€ä¸ªåæ¬¡åº”è¯¥æ˜¯ä¸‹ä¸€ä¸ªè¿ç»­çš„æ•´æ•°å€¼ã€‚æ¢å¥è¯è¯´ï¼Œåæ¬¡ä¹‹é—´ä¸åº”è¯¥æœ‰â€œé—´éš”â€ã€‚
//
// +----+-------+
//| Id | Score |
//+----+-------+
//| 1  | 3.50  |
//| 2  | 3.65  |
//| 3  | 4.00  |
//| 4  | 3.85  |
//| 5  | 4.00  |
//| 6  | 3.65  |
//+----+-------+
//
//
// ä¾‹å¦‚ï¼Œæ ¹æ®ä¸Šè¿°ç»™å®šçš„ Scores è¡¨ï¼Œä½ çš„æŸ¥è¯¢åº”è¯¥è¿”å›ï¼ˆæŒ‰åˆ†æ•°ä»é«˜åˆ°ä½æ’åˆ—ï¼‰ï¼š
//
// +-------+------+
//| Score | Rank |
//+-------+------+
//| 4.00  | 1    |
//| 4.00  | 1    |
//| 3.85  | 2    |
//|Â 3.65  | 3    |
//| 3.65  | 3    |
//| 3.50  | 4    |
//+-------+------+
//
//
// é‡è¦æç¤ºï¼šå¯¹äº MySQL è§£å†³æ–¹æ¡ˆï¼Œå¦‚æœè¦è½¬ä¹‰ç”¨ä½œåˆ—åçš„ä¿ç•™å­—ï¼Œå¯ä»¥åœ¨å…³é”®å­—ä¹‹å‰å’Œä¹‹åä½¿ç”¨æ’‡å·ã€‚ä¾‹å¦‚ `Rank`
// ğŸ‘ 600 ğŸ‘ 0
</code></pre><h3 id=è§£æ³•>è§£æ³•</h3><p>ä¸€å¼€å§‹æƒ³ï¼Œmysqlä¼šä¸ä¼šæœ‰ä»€ä¹ˆç³»ç»Ÿå‡½æ•°å¯ä»¥å¾—åˆ°å½“å‰è¡Œçš„ç´¢å¼•ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°æ’åäº†ï¼Œå¥½çš„ï¼Œmysqlä½ç‰ˆæœ¬æ˜¯æ²¡æœ‰è¿™ç§å‡½æ•°çš„ï¼Œé«˜ç‰ˆæœ¬æœ‰ä¸€ä¸ªdense_rank()å‡½æ•°å¯ä»¥ç›´æ¥å¾—åˆ°æ’åã€‚ä½†æ˜¯æˆ‘æœ¬åœ°æ˜¯ä½ç‰ˆæœ¬çš„ï¼Œäºæ˜¯ã€‚ã€‚ã€‚æˆ‘ä¸ä¼šåšäº†ï¼Œçœ‹äººå®¶çš„é¢˜è§£å­=-=&lsquo;&lsquo;&lsquo;æ€è·¯å°±æ˜¯ï¼š <strong>å‡è®¾å½“å‰åˆ†æ•°æ˜¯Xï¼Œé‚£ä¹ˆæŸ¥æ‰¾å¤§äºXçš„ä¸é‡å¤ä¸ªæ•°ï¼ˆå¹³åˆ†çš„äººæ˜¯åŒä¸ªåæ¬¡ï¼‰Gï¼Œé‚£ä¹ˆG+1å°±æ˜¯åˆ†æ•°Xçš„åæ¬¡</strong> ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>select Score,(
        select count(distinct Score)+1 from Scores a where a.Score&gt;b.Score
) as `Rank` from Scores b order by Score desc;
</code></pre><h2 id=180è¿ç»­å‡ºç°çš„æ•°å­—>[180]è¿ç»­å‡ºç°çš„æ•°å­—</h2><p>é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>//ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾æ‰€æœ‰è‡³å°‘è¿ç»­å‡ºç°ä¸‰æ¬¡çš„æ•°å­—ã€‚
//
// +----+-----+
//| Id | Num |
//+----+-----+
//| 1  |  1  |
//| 2  |  1  |
//| 3  |  1  |
//| 4  |  2  |
//| 5  |  1  |
//| 6  |  2  |
//| 7  |  2  |
//+----+-----+
//
//
// ä¾‹å¦‚ï¼Œç»™å®šä¸Šé¢çš„ Logs è¡¨ï¼Œ 1 æ˜¯å”¯ä¸€è¿ç»­å‡ºç°è‡³å°‘ä¸‰æ¬¡çš„æ•°å­—ã€‚
//
// +-----------------+
//| ConsecutiveNums |
//+-----------------+
//| 1               |
//+-----------------+
//
// ğŸ‘ 305 ğŸ‘ 0
</code></pre><h3 id=è§£æ³•-1>è§£æ³•</h3><p>è‡³å°‘è¿ç»­å‡ºç°ä¸‰æ¬¡ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯è¿ç»­çš„ä¸‰è¡Œï¼Œé‚£ä¹ˆå®ƒä»¬çš„idä¹Ÿæ˜¯è¿ç»­çš„ä¸”numç›¸ç­‰ï¼Œæ ¹æ®è¿™ä¸ªæ¡ä»¶ï¼Œæ„é€ æŸ¥è¯¢å¦‚ä¸‹ï¼š</p><pre><code>select distinct a.Num as ConsecutiveNums from Logs a,Logs b,Logs c
        where a.Id+1=b.Id and b.Id+1=c.Id
            and a.Num=b.Num and b.Num=c.Num;
</code></pre><h2 id=181è¶…è¿‡ç»ç†æ”¶å…¥çš„å‘˜å·¥>[181]è¶…è¿‡ç»ç†æ”¶å…¥çš„å‘˜å·¥</h2><p>é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>//Employee è¡¨åŒ…å«æ‰€æœ‰å‘˜å·¥ï¼Œä»–ä»¬çš„ç»ç†ä¹Ÿå±äºå‘˜å·¥ã€‚æ¯ä¸ªå‘˜å·¥éƒ½æœ‰ä¸€ä¸ª Idï¼Œæ­¤å¤–è¿˜æœ‰ä¸€åˆ—å¯¹åº”å‘˜å·¥çš„ç»ç†çš„ Idã€‚
//
// +----+-------+--------+-----------+
//| Id | Name  | Salary | ManagerId |
//+----+-------+--------+-----------+
//| 1  | Joe   | 70000  | 3         |
//| 2  | Henry | 80000  | 4         |
//| 3  | Sam   | 60000  | NULL      |
//| 4  | Max   | 90000  | NULL      |
//+----+-------+--------+-----------+
//
//
// ç»™å®š Employee è¡¨ï¼Œç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œè¯¥æŸ¥è¯¢å¯ä»¥è·å–æ”¶å…¥è¶…è¿‡ä»–ä»¬ç»ç†çš„å‘˜å·¥çš„å§“åã€‚åœ¨ä¸Šé¢çš„è¡¨æ ¼ä¸­ï¼ŒJoe æ˜¯å”¯ä¸€ä¸€ä¸ªæ”¶å…¥è¶…è¿‡ä»–çš„ç»ç†çš„å‘˜å·¥ã€‚
//
//
// +----------+
//| Employee |
//+----------+
//| Joe      |
//+----------+
//
// ğŸ‘ 308 ğŸ‘ 0
</code></pre><h3 id=è§£æ³•-2>è§£æ³•</h3><p>é€šè¿‡Idå’ŒManagerIdè¿æ¥èµ·æ¥ä¸¤æ¡è®°å½•ï¼Œç„¶åæ¯”è¾ƒå…¶Salaryï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>select a.Name as Employee from Employee a,Employee b where a.ManagerId=b.Id and a.Salary&gt;b.Salary;
</code></pre><h2 id=182æŸ¥æ‰¾é‡å¤çš„ç”µå­é‚®ç®±>[182]æŸ¥æ‰¾é‡å¤çš„ç”µå­é‚®ç®±</h2><p>é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>//ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾ Person è¡¨ä¸­æ‰€æœ‰é‡å¤çš„ç”µå­é‚®ç®±ã€‚
//
// ç¤ºä¾‹ï¼š
//
// +----+---------+
//| Id | Email   |
//+----+---------+
//| 1  | a@b.com |
//| 2  | c@d.com |
//| 3  | a@b.com |
//+----+---------+
//
//
// æ ¹æ®ä»¥ä¸Šè¾“å…¥ï¼Œä½ çš„æŸ¥è¯¢åº”è¿”å›ä»¥ä¸‹ç»“æœï¼š
//
// +---------+
//| Email   |
//+---------+
//| a@b.com |
//+---------+
//
//
// è¯´æ˜ï¼šæ‰€æœ‰ç”µå­é‚®ç®±éƒ½æ˜¯å°å†™å­—æ¯ã€‚
// ğŸ‘ 229 ğŸ‘ 0
</code></pre><h3 id=è§£æ³•-3>è§£æ³•</h3><p>æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ª <code>group by</code> ï¼Œéœ€è¦æ³¨æ„çš„å°±æ˜¯èšåˆå‡½æ•°å¯ä»¥æ”¾åœ¨ <code>having</code> åé¢ä½œä¸ºæ¡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>select Email from Person group by Email having count(*)&gt;1;
</code></pre><h2 id=183ä»ä¸è®¢è´­çš„å®¢æˆ·>[183]ä»ä¸è®¢è´­çš„å®¢æˆ·</h2><p>é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>//æŸç½‘ç«™åŒ…å«ä¸¤ä¸ªè¡¨ï¼ŒCustomers è¡¨å’Œ Orders è¡¨ã€‚ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ‰¾å‡ºæ‰€æœ‰ä»ä¸è®¢è´­ä»»ä½•ä¸œè¥¿çš„å®¢æˆ·ã€‚
//
// Customers è¡¨ï¼š
//
// +----+-------+
//| Id | Name  |
//+----+-------+
//| 1  | Joe   |
//| 2  | Henry |
//| 3  | Sam   |
//| 4  | Max   |
//+----+-------+
//
//
// Orders è¡¨ï¼š
//
// +----+------------+
//| Id | CustomerId |
//+----+------------+
//| 1  | 3          |
//| 2  | 1          |
//+----+------------+
//
//
// ä¾‹å¦‚ç»™å®šä¸Šè¿°è¡¨æ ¼ï¼Œä½ çš„æŸ¥è¯¢åº”è¿”å›ï¼š
//
// +-----------+
//| Customers |
//+-----------+
//| Henry     |
//| Max       |
//+-----------+
//
// ğŸ‘ 172 ğŸ‘ 0
</code></pre><h3 id=è§£æ³•-4>è§£æ³•</h3><p>æ¯”è¾ƒç®€å•ï¼Œç”¨ <code>not in</code> å°±å¯ä»¥å•¦ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>select Name as Customers from Customers where Id not in(
        select distinct CustomerId from Orders
);
</code></pre><h2 id=184éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥>[184]éƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥</h2><p>é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>//Employee è¡¨åŒ…å«æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ï¼Œæ¯ä¸ªå‘˜å·¥æœ‰å…¶å¯¹åº”çš„ Id, salary å’Œ department Idã€‚
//
// +----+-------+--------+--------------+
//| Id | Name  | Salary | DepartmentId |
//+----+-------+--------+--------------+
//| 1  | Joe   | 70000  | 1            |
//| 2 Â | Jim Â  | 90000 Â | 1 Â  Â  Â  Â  Â  Â |
//| 3  | Henry | 80000  | 2            |
//| 4  | Sam   | 60000  | 2            |
//| 5  | Max   | 90000  | 1            |
//+----+-------+--------+--------------+
//
// Department è¡¨åŒ…å«å…¬å¸æ‰€æœ‰éƒ¨é—¨çš„ä¿¡æ¯ã€‚
//
// +----+----------+
//| Id | Name     |
//+----+----------+
//| 1  | IT       |
//| 2  | Sales    |
//+----+----------+
//
// ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨å·¥èµ„æœ€é«˜çš„å‘˜å·¥ã€‚å¯¹äºä¸Šè¿°è¡¨ï¼Œæ‚¨çš„ SQL æŸ¥è¯¢åº”è¿”å›ä»¥ä¸‹è¡Œï¼ˆè¡Œçš„é¡ºåºæ— å…³ç´§è¦ï¼‰ã€‚
//
// +------------+----------+--------+
//| Department | Employee | Salary |
//+------------+----------+--------+
//| IT         | Max      | 90000  |
//| IT Â  Â  Â  Â  | Jim Â  Â  Â | 90000 Â |
//| Sales      | Henry    | 80000  |
//+------------+----------+--------+
//
// è§£é‡Šï¼š
//
// Max å’Œ Jim åœ¨ IT éƒ¨é—¨çš„å·¥èµ„éƒ½æ˜¯æœ€é«˜çš„ï¼ŒHenry åœ¨é”€å”®éƒ¨çš„å·¥èµ„æœ€é«˜ã€‚
// ğŸ‘ 287 ğŸ‘ 0
</code></pre><h3 id=è§£æ³•-5>è§£æ³•</h3><p>ä¸€å¼€å§‹æƒ³åˆ°äº† <code>IN</code> ï¼Œä½†æ˜¯ä¸çŸ¥é“å¯ä»¥ <code>IN</code> å¤šä¸ªå­—æ®µï¼Œæ€è·¯å°±æ˜¯ï¼š <strong>å…ˆæŸ¥è¯¢å‡ºéƒ¨é—¨IDä»¥åŠå¯¹åº”éƒ¨é—¨æœ€é«˜å·¥èµ„ï¼Œç„¶åæŸ¥è¯¢Employeeä¸­éƒ¨é—¨IDå’Œå·¥èµ„INæŸ¥è¯¢å‡ºæ¥çš„ç»“æœï¼ˆINçš„å­—æ®µè¦å¯¹åº”ï¼‰</strong> ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>select D.Name as Department,E.Name as Employee,E.Salary as Salary
        from Department D,Employee E
        where D.Id=E.DepartmentId and (E.DepartmentId,E.Salary) in (
        select F.DepartmentId,max(F.Salary) from Employee F group by F.DepartmentId
    );
</code></pre><h2 id=175ç»„åˆä¸¤ä¸ªè¡¨>[175]ç»„åˆä¸¤ä¸ªè¡¨</h2><p>é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>//è¡¨1: Person
//
// +-------------+---------+
//| åˆ—å         | ç±»å‹     |
//+-------------+---------+
//| PersonId    | int     |
//| FirstName   | varchar |
//| LastName    | varchar |
//+-------------+---------+
//PersonId æ˜¯ä¸Šè¡¨ä¸»é”®
//
//
// è¡¨2: Address
//
// +-------------+---------+
//| åˆ—å         | ç±»å‹    |
//+-------------+---------+
//| AddressId   | int     |
//| PersonId    | int     |
//| City        | varchar |
//| State       | varchar |
//+-------------+---------+
//AddressId æ˜¯ä¸Šè¡¨ä¸»é”®
//
//
//
//
// ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ»¡è¶³æ¡ä»¶ï¼šæ— è®º person æ˜¯å¦æœ‰åœ°å€ä¿¡æ¯ï¼Œéƒ½éœ€è¦åŸºäºä¸Šè¿°ä¸¤è¡¨æä¾› person çš„ä»¥ä¸‹ä¿¡æ¯ï¼š
//
//
//
// FirstName, LastName, City, State
//
// ğŸ‘ 667 ğŸ‘ 0
</code></pre><h3 id=è§£æ³•-6>è§£æ³•</h3><p>å°±æ˜¯ä¸€ä¸ªå·¦è¿æ¥ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>select FirstName,LastName,A.City,A.State from Person left join Address A on Person.PersonId = A.PersonId;
</code></pre><h2 id=176ç¬¬äºŒé«˜çš„è–ªæ°´>[176]ç¬¬äºŒé«˜çš„è–ªæ°´</h2><p>é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>//ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œè·å– Employee è¡¨ä¸­ç¬¬äºŒé«˜çš„è–ªæ°´ï¼ˆSalaryï¼‰ ã€‚
//
// +----+--------+
//| Id | Salary |
//+----+--------+
//| 1  | 100    |
//| 2  | 200    |
//| 3  | 300    |
//+----+--------+
//
//
// ä¾‹å¦‚ä¸Šè¿° Employee è¡¨ï¼ŒSQLæŸ¥è¯¢åº”è¯¥è¿”å› 200 ä½œä¸ºç¬¬äºŒé«˜çš„è–ªæ°´ã€‚å¦‚æœä¸å­˜åœ¨ç¬¬äºŒé«˜çš„è–ªæ°´ï¼Œé‚£ä¹ˆæŸ¥è¯¢åº”è¿”å› nullã€‚
//
// +---------------------+
//| SecondHighestSalary |
//+---------------------+
//| 200                 |
//+---------------------+
//
// ğŸ‘ 637 ğŸ‘ 0
</code></pre><h3 id=è§£æ³•-7>è§£æ³•</h3><p>è¿”å›ç¬¬äºŒé«˜ï¼Œæƒ³åˆ°ç”¨ <code>limit 1,1</code> ,ä½†æ˜¯é¢˜ç›®å¤šäº†ä¸€ä¸ªéœ€è¦è¿”å›nullçš„æ¡ä»¶ï¼Œäºæ˜¯å¯ä»¥ç”¨ <code>IFNULL(æ¡ä»¶,ä¸ºnullçš„ç»“æœ)</code> ç³»ç»Ÿå‡½æ•°æ¥å¤„ç†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>select IFNULL((select distinct Salary from Employee order by Salary desc limit 1,1),null) as SecondHighestSalary;
</code></pre><h2 id=177ç¬¬né«˜çš„è–ªæ°´>[177]ç¬¬Né«˜çš„è–ªæ°´</h2><p>é¢˜ç›®å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>//ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œè·å– Employee è¡¨ä¸­ç¬¬ n é«˜çš„è–ªæ°´ï¼ˆSalaryï¼‰ã€‚
//
// +----+--------+
//| Id | Salary |
//+----+--------+
//| 1  | 100    |
//| 2  | 200    |
//| 3  | 300    |
//+----+--------+
//
//
// ä¾‹å¦‚ä¸Šè¿° Employee è¡¨ï¼Œn = 2 æ—¶ï¼Œåº”è¿”å›ç¬¬äºŒé«˜çš„è–ªæ°´ 200ã€‚å¦‚æœä¸å­˜åœ¨ç¬¬ n é«˜çš„è–ªæ°´ï¼Œé‚£ä¹ˆæŸ¥è¯¢åº”è¿”å› nullã€‚
//
// +------------------------+
//| getNthHighestSalary(2) |
//+------------------------+
//| 200                    |
//+------------------------+
//
// ğŸ‘ 345 ğŸ‘ 0
</code></pre><h3 id=è§£æ³•å¦‚ä¸‹>è§£æ³•å¦‚ä¸‹ï¼š</h3><p>è¿™ä¸ªé¢˜å’Œä¸Šä¸€ä¸ªé¢˜[176]å¾ˆç±»ä¼¼ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯ <code>limit offset,count</code> ä¸­çš„offsetæ˜¯ä»0å¼€å§‹çš„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT
BEGIN
    SET N=N-1;
    RETURN (
        # Write your MySQL query statement below.
        IFNULL((select distinct Salary from Employee order by Salary desc limit N,1),null)
    );
END
</code></pre></div><div class=post-copyright><p class=copyright-item><span class=item-title>æ–‡ç« ä½œè€…</span>
<span class=item-content>P1n93r</span></p><p class=copyright-item><span class=item-title>ä¸Šæ¬¡æ›´æ–°</span>
<span class=item-content>2020-09-16</span></p></div><footer class=post-footer><nav class=post-nav><a class=prev href=/post/security/cewlkid/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">CewlKid: 1</span>
<span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span></a>
<a class=next href=/post/data_tructure/leetcode%E7%AE%97%E6%B3%95%E7%AC%AC%E4%B8%80%E5%A4%A9/><span class="next-text nav-default">LeetCodeç®—æ³•(ç¬¬ä¸€å¤©)</span>
<span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname==="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="p1n93r",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:pin83r@gmail.com class="iconfont icon-email" title=email></a>
<a href=https://github.com/p1n93r class="iconfont icon-github" title=github></a>
<a href=https://p1n93r.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>ç”± <a class=hexo-link href=https://gohugo.io>Hugo</a> å¼ºåŠ›é©±åŠ¨</span>
<span class=division>|</span>
<span class=theme-info>ä¸»é¢˜ -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>æœ¬ç«™æ€»è®¿é—®é‡ <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span> æ¬¡</span>
<span class=division>|</span>
<span id=busuanzi_container_site_uv>æœ¬ç«™æ€»è®¿å®¢æ•° <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span> äºº</span></div><span class=copyright-year>&copy;
2019 -
2022<span class=heart><i class="iconfont icon-heart"></i></span><span>P1n93r</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js></script></body></html>